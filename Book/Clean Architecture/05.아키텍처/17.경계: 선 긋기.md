## 경계: 선 긋기

- 소프트웨어 아키텍처는 선을 긋는 기술이며, 이러한 선을 경계(boundary)라고 부른다
    - 경계는 소프트웨어 요소를 서로 분리하고, 경계 한편에 있는 요소가 다른 반대편에 있는 요소를 알지 못하도록 막는다
- `아키텍트의 목표는 필요한 시스템을 만들고 유지하는데 드는 인적 자원을 최소화 하는 것이다`
    - `인적 자원의 효율을 떨어뜨리는 요인은 바로 결합(coupling)이다. 특히 너무 일찍 내려진 결정에 따른 결합이다`
- 어떤 종류의 결정이 이른 결정일까?
    - 바로 시스템의 업무 요구사항, 즉 유스케이스와 아무런 관련이 없는 결정이다
    - 프레임 워크, 데이터베이스, 웹 서버, 유틸리티 라이브러리, 의존성 주입에 대한 결정 등이 여기에 포함된다
    - `좋은 아키텍처는 이런 결정에 의존하지 않는다. 좋은 시스템 아키텍처는 이러한 결정을 가능한 한 최후의 순간에 내릴 수 있게 해주며 결정에 따른 영향이 크지 않게 만든다`

### FItNesse

- 성공 케에스를 예시
- 어떤 데이터베이스를 사용하더라도 상관없는 형태로 설계함으로써 의도적으로 데이터베이스에 대한 결정을 미루었다
    - 모든 데이터 접근 영역과 데이터 저장소 영역 사이에 인터페이스를 추가하여 간단한 설계 방식을 사용했다
    - 데이터 접근 메서드들을 인터페이스에 두었다
    - 물론 처음에는 이들 메서드를 구현하지 않았다 &rarr; 실제로 데이터에 접근하는 일이 있을 발생했을 때 구현하기 시작했다
    - 즉, 개발 초기에 업무 규칙과 데이터베이스 사이에 경계선을 그었다. 이 경계선을 통해 업무 규칙은 데이터 접근 메서드 외에는 데이터베이스 관해서 어떤 것도 알지 못하게 하였다

### 어떻게 선을 그을까? 그리고 언제 그일까?

<img src = "/Users/hyun/Desktop/Master/Book/Clean Architecture/05.아키텍처/IMG_5426.jpg" width = "600" height = "300">

- 데이터베이스는 업무 규칙과 서로 떼어놓을 수 없는 관계라고 배운 사람이 많다. 심지어 업무 규칙이 구체화 된 것이 바로 데이터베이스라고 확신하는 사람도 더라 있다
    - 하지만 이는 잘못된 생각이다
    - 데이터베이스는 업무 규칙이 간접적으로 사용할 수 있는 도구다
    - 업무 규칙은 스키마, 쿼리 언어, 또는 데이터베이스와 관련된 나머지 세부사항에 대해 어떤 것도 알아서는 안된다
    - 업무 규칙이 알아야 할 것은 데이터를 가져오고 저장할 때 사용할 수 있는 함수 집합이 있다는 사실이 전부다
    - 이러한 함수 집합을 통해서 우리는 데이터베이스를 인터페이스 뒤로 숨길 수 있다
  
- 경계선은 어디에 있는가

  <img src = "/Users/hyun/Desktop/Master/Book/Clean Architecture/05.아키텍처/IMG_5427.jpg" width = "600" height = "300">

    - DatabaseAccess에서 출발하는 두 화살표에 주목하자. 두 화살표는 DatabaseAccess클래스로 부터 바깥쪽으로 향한다
    - `즉, 이 도표에서 DatabaseAccess가 존재한다는 사실을 알고 있는 클래스는 없다는 뜻이다`
    - 이 화살표를 통해서 BusinessRules는 Databse는 문제가 되지 않지만, Database는 BusinessRules없이는 존재할 수 없다는 것을 알 수 있다

### 입력과 출력은?

  <img src = "/Users/hyun/Desktop/Master/Book/Clean Architecture/05.아키텍처/IMG_5429.jpg" width = "600" height = "300">

- 입력과 출력은 중요하지 않다
    - 게임 화면에 전혀 출력되지 않더라도 모델은 게임에서 발생되는 모든 이벤트를 모델링 하면서 주어진 역할을 충실하게 수행한다
- 마찬가지로 GUI와 BusinessRules 컴포넌트가 경계선에 의해 분할된다
- GUI가 BusinessRules를 신경쓴다 &rarr; BusinessRules는 GUI를 전혀 개의지 않는다

### 플러그인 아키텍처

  <img src = "/Users/hyun/Desktop/Master/Book/Clean Architecture/05.아키텍처/IMG_5430.jpg" width = "600" height = "300">

- 데이터베이스와 GUI에 대해 내린 두 가지 결정을 하나로 합여서 보면 컴포넌트 추가와 관련된 일종의 패턴이 만들어 진다
    - `즉, 선택적이거나 또는 수많은 다양한 형태로 구현될 수 있는 나머지 컴포넌트로 부터 핵심적인 업무 규칙은 분리되어 있고 또한 독립적이다`
- 위 이미지에 나온 설계에서는 인터페이스를 프러그인 형태로 연결 할 수 있게 된다
    - 웹 기반일 수도 있고, 클라이언트/서버 기반이나, 콘솔 기반 어떤 기술이라도 가능하다
- 데이터베이스도 플러그인으로 다루기로 결정했기 때문에 임의의 다양한 SQL데이터베이스 NoSQL데이터 베이스, 파일 시스템 기반 데이터베이스 어떤 종류의 데이터베이스 기술로도 대체할 수 있다

### 플러그인에 대한 논의

- `경계는 변경의 축 (axis of change)이 있는 지점에 그어진다`
- 경계의 한쪽에 위치한 컴포넌트는 경계 반대편의 컴포넌트와는 다른 속도로, 그리고 다른 이유로 변경된다
- GUI업무 규칙과는 다른 시점에 다른 속도로 변경되므로, 둘 사이에는 반드시 경계가 필요하다

### 결론

- 소프트웨어 이키텍처에서 경계선을 그리려면 먼저 시스템을 컴포넌트 다윈로 분할해야 한다.
- 일부 컴포넌트는 핵심 업무 규치ㅏㄱ에 해당한다. 나머지 컴포넌트는 플로그인으로, 핵심 업무와는 직접적인 관련이 없지만 필수 기능을 포함한다
- 그런 다음 컴포넌트 사이의 화살표가 특정 방향, 즉 핵심 업무를 향하도록 이들 컴포넌트의 소스를 배치한다
- 이는 의존서 ㅇ역젼 원칙과 언정된 추상화 원칙응 응용한 것임을 눈치챌 수 있어야 한다
- 의조선 화살표는 저수준 세부사항에서 고수준 추상화를 향하도록 배치된다 